<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙƒÙ…Ø´ÙƒØ§Ø© | ÙŠÙˆØ¯ÙŠÙ…ÙŠ</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="js/main.js"></script>
    <!-- Ù„Ø§Ø²Ù… Ø§Ù„Ù…Ù„Ù Ø¯Ù‡ ÙŠØªØ­Ù…Ù„ Ø¹Ø´Ø§Ù† ÙÙŠÙ‡ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª -->
    <script src="js/udemy-data.js"></script>
</head>
<body data-page="courses">
    <div class="fixed-bg"><img src="images/ui/bg.jpg"></div>
    <div id="header-ph"></div>

    <main class="pt-32 px-4 container mx-auto min-h-screen pb-12">
        <h1 class="text-2xl md:text-3xl font-black text-purple-900 mb-8 border-r-4 border-purple-500 pr-4">ÙƒÙˆØ±Ø³Ø§Øª ÙŠÙˆØ¯ÙŠÙ…ÙŠ (ÙƒÙˆØ¨ÙˆÙ†Ø§Øª)</h1>
        
        <!-- Search & Filter Section -->
        <div class="mb-10 fade-in space-y-6">
            <!-- Search Bar -->
            <div class="relative max-w-xl mx-auto group">
                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                    <i data-lucide="search" class="w-5 h-5 text-slate-400 group-focus-within:text-purple-600 transition"></i>
                </div>
                <input type="text" id="search-input" 
                    class="block w-full p-4 pr-10 text-sm text-slate-900 border border-slate-200 rounded-full bg-white/80 focus:ring-4 focus:ring-purple-200 focus:border-purple-500 focus:bg-white transition-all duration-300 shadow-sm focus:w-full" 
                    placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒÙˆØ±Ø³ (ÙÙˆØªÙˆØ´ÙˆØ¨ØŒ Ø¨Ø§ÙŠØ«ÙˆÙ†...)">
            </div>

            <!-- Categories Container (Dynamic) -->
            <div class="space-y-4">
                <!-- Main Categories -->
                <div class="flex flex-wrap justify-center gap-2" id="main-cats-container">
                    <!-- Ù‡ÙŠØªÙ… Ø±Ø³Ù… Ø§Ù„Ø²Ø±Ø§ÙŠØ± Ù‡Ù†Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                </div>
                
                <!-- Sub Categories (Hidden by default) -->
                <div id="sub-cats-wrapper" class="hidden bg-purple-50/50 p-4 rounded-2xl border border-purple-100">
                    <p class="text-xs font-bold text-purple-800 mb-2 text-center">ØªØµÙÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø©:</p>
                    <div class="flex flex-wrap justify-center gap-2" id="sub-cats-container"></div>
                </div>
            </div>
        </div>

        <!-- Grid -->
        <div id="udemy-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 fade-in">
            <!-- Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ù‡ØªÙ†Ø²Ù„ Ù‡Ù†Ø§ -->
        </div>

        <div class="text-center mt-12 fade-in" id="load-more-container">
            <button id="load-more-udemy" class="bg-purple-600 text-white px-8 py-3 rounded-full font-bold hover:bg-purple-700 transition shadow-lg items-center gap-2 inline-flex">
                Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ <i data-lucide="arrow-down" class="w-5 h-5"></i>
            </button>
        </div>
    </main>

    <div id="footer-ph"></div>

    <script>
        let currentUdemyCount = 0;
        const UDEMY_BATCH_SIZE = 9;
        let activeMainCat = 'all';
        let activeSubCat = 'all';
        let searchQuery = '';
        let filteredData = [];

        document.addEventListener('DOMContentLoaded', () => {
            renderCategories(); // Ø±Ø³Ù… Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ø£ÙˆÙ„
            filterData(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª
            
            document.getElementById('search-input').addEventListener('keyup', (e) => {
                searchQuery = e.target.value.toLowerCase();
                currentUdemyCount = 0;
                filterData();
            });

            document.getElementById('load-more-udemy').addEventListener('click', () => {
                renderBatch();
            });
        });

        // 1. Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
        function renderCategories() {
            const mainContainer = document.getElementById('main-cats-container');
            const categories = window.udemyCategories || [];

            // Ø²Ø±Ø§Ø± "Ø§Ù„ÙƒÙ„"
            let html = `
                <button onclick="selectCategory('all', this)" class="cat-btn active px-4 py-2 rounded-full font-bold text-xs md:text-sm bg-purple-600 text-white shadow-md transition hover:scale-105 border border-transparent">
                    Ø§Ù„ÙƒÙ„
                </button>
            `;

            // Ø±Ø³Ù… Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ù…Ù† Ø§Ù„Ù…Ù„Ù
            categories.forEach(cat => {
                html += `
                <button onclick="selectCategory('${cat.id}', this)" class="cat-btn px-4 py-2 rounded-full font-bold text-xs md:text-sm bg-white text-slate-600 hover:bg-purple-50 transition border border-slate-200 flex items-center gap-2">
                    <i data-lucide="${cat.icon}" class="w-4 h-4"></i> ${cat.title}
                </button>
                `;
            });

            mainContainer.innerHTML = html;
            lucide.createIcons();
        }

        // 2. Ø¯Ø§Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
        window.selectCategory = function(catId, btn) {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³ØªØ§ÙŠÙ„
            document.querySelectorAll('.cat-btn').forEach(b => {
                b.classList.remove('bg-purple-600', 'text-white', 'active');
                b.classList.add('bg-white', 'text-slate-600');
            });
            btn.classList.remove('bg-white', 'text-slate-600');
            btn.classList.add('bg-purple-600', 'text-white', 'active');

            activeMainCat = catId;
            activeSubCat = 'all'; // ØªØµÙÙŠØ± Ø§Ù„ÙØ±Ø¹ÙŠ
            currentUdemyCount = 0;

            // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ©
            renderSubCategories(catId);
            filterData();
        }

        // 3. Ø±Ø³Ù… Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ©
        function renderSubCategories(catId) {
            const subWrapper = document.getElementById('sub-cats-wrapper');
            const subContainer = document.getElementById('sub-cats-container');
            
            if (catId === 'all') {
                subWrapper.classList.add('hidden');
                return;
            }

            // Ù‡Ø§Øª Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø®ØªØ§Ø±
            const selectedCatData = window.udemyCategories.find(c => c.id === catId);
            
            if (selectedCatData && selectedCatData.sub) {
                let html = `
                    <button onclick="selectSubCategory('all', this)" class="sub-cat-btn active px-3 py-1 rounded-lg text-xs font-bold bg-purple-200 text-purple-800 border border-purple-300">
                        Ø§Ù„ÙƒÙ„
                    </button>
                `;
                
                selectedCatData.sub.forEach(sub => {
                    html += `
                    <button onclick="selectSubCategory('${sub}', this)" class="sub-cat-btn px-3 py-1 rounded-lg text-xs font-bold bg-white text-slate-500 border border-purple-100 hover:bg-purple-100 transition">
                        ${sub}
                    </button>
                    `;
                });

                subContainer.innerHTML = html;
                subWrapper.classList.remove('hidden');
                subWrapper.classList.add('animate-fade-in-down'); // Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¨Ø³ÙŠØ·
            } else {
                subWrapper.classList.add('hidden');
            }
        }

        // 4. Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„ÙØ±Ø¹ÙŠ
        window.selectSubCategory = function(subName, btn) {
            document.querySelectorAll('.sub-cat-btn').forEach(b => {
                b.classList.remove('bg-purple-200', 'text-purple-800', 'border-purple-300');
                b.classList.add('bg-white', 'text-slate-500', 'border-purple-100');
            });
            btn.classList.remove('bg-white', 'text-slate-500', 'border-purple-100');
            btn.classList.add('bg-purple-200', 'text-purple-800', 'border-purple-300');

            activeSubCat = subName;
            currentUdemyCount = 0;
            filterData();
        }

        // 5. Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        function filterData() {
            const grid = document.getElementById('udemy-grid');
            grid.innerHTML = '';

            if(!window.udemyData) return;

            filteredData = window.udemyData.filter(c => {
                // ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø«
                const matchSearch = c.titleAr.toLowerCase().includes(searchQuery) || c.titleEn.toLowerCase().includes(searchQuery);
                
                // ÙÙ„ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                let matchMain = true;
                if (activeMainCat !== 'all') {
                    // Ø¨Ù†Ø¬ÙŠØ¨ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ù„ØªØµÙ†ÙŠÙ (Development, Business...)
                    const catObj = window.udemyCategories.find(x => x.id === activeMainCat);
                    if (catObj) {
                        // Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø±Ù†Ø© (Ù„Ùˆ Ø§Ù„Ø¯Ø§ØªØ§ ÙÙŠÙ‡Ø§ Development Ùˆ Ø§Ù„Ù€ ID development)
                        matchMain = c.cat && c.cat.toLowerCase() === catObj.title.toLowerCase();
                    }
                }

                // ÙÙ„ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„ÙØ±Ø¹ÙŠ
                let matchSub = true;
                if (activeSubCat !== 'all') {
                    matchSub = c.subCat && c.subCat === activeSubCat;
                }

                return matchSearch && matchMain && matchSub;
            });

            // Ù„Ùˆ Ù…ÙÙŠØ´ Ù†ØªØ§ÙŠØ¬
            if (filteredData.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-16 bg-white/50 rounded-3xl border border-dashed border-slate-300">
                        <div class="bg-slate-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse">
                            <i data-lucide="search-x" class="w-10 h-10 text-slate-400"></i>
                        </div>
                        <p class="text-slate-600 font-bold text-lg mb-2">Ù…ÙÙŠØ´ ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù‚Ø³Ù… Ø¯Ù‡ ğŸ˜”</p>
                        <p class="text-slate-500 text-sm">Ø¬Ø±Ø¨ Ù‚Ø³Ù… ØªØ§Ù†ÙŠ Ø£Ùˆ Ø§Ø±Ø¬Ø¹ ÙˆÙ‚Øª ØªØ§Ù†ÙŠØŒ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ø¨ØªØªØ¬Ø¯Ø¯!</p>
                        <button onclick="selectCategory('all', document.querySelector('.cat-btn'))" class="mt-4 text-purple-600 font-bold hover:underline">Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</button>
                    </div>
                `;
                document.getElementById('load-more-container').style.display = 'none';
                lucide.createIcons();
            } else {
                document.getElementById('load-more-container').style.display = 'block';
                renderBatch();
            }
        }

        function renderBatch() {
            const grid = document.getElementById('udemy-grid');
            const btn = document.getElementById('load-more-udemy');
            
            const start = currentUdemyCount;
            const end = start + UDEMY_BATCH_SIZE;
            const batch = filteredData.slice(start, end);

            if (end >= filteredData.length) {
                btn.style.display = 'none';
            } else {
                btn.style.display = 'inline-flex';
            }

            const html = batch.map(c => {
                return `
                <div class="glass-panel rounded-2xl overflow-hidden group flex flex-col h-full hover:-translate-y-2 transition duration-300 fade-in border border-white/50">
                    <div class="relative h-48 overflow-hidden">
                        <img src="${c.img}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500" onerror="this.src='https://placehold.co/600x400/8b5cf6/ffffff?text=Udemy'">
                        <span class="absolute top-3 left-3 bg-white/90 backdrop-blur-sm text-purple-700 text-xs font-bold px-3 py-1 rounded-full shadow-sm z-10">
                            ${c.cat}
                        </span>
                    </div>
                    <div class="p-5 flex-1 flex flex-col">
                        <div class="flex items-center gap-1 text-xs text-slate-500 font-bold mb-2">
                            <i data-lucide="clock" class="w-3 h-3"></i> ${c.date || 'Ù„ÙØªØ±Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©'}
                        </div>
                        <h3 class="font-bold text-lg mb-2 text-slate-900 leading-snug line-clamp-2" title="${c.titleEn}">${c.titleAr}</h3>
                        <p class="text-slate-500 text-sm mb-4 line-clamp-2">${c.desc}</p>
                        
                        <div class="mt-auto flex gap-2">
                            <a href="${c.url}" target="_blank" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2.5 rounded-xl text-center font-bold transition text-sm flex items-center justify-center gap-2 shadow-md shadow-purple-200">
                                Ø§Ø­ØµÙ„ Ø¹Ù„ÙŠÙ‡ <i data-lucide="external-link" class="w-4 h-4"></i>
                            </a>
                            <button onclick="shareLink('${c.titleAr}', '${c.url}')" class="px-3 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl flex items-center justify-center transition border border-blue-200">
                                <i data-lucide="share-2" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `}).join('');

            grid.insertAdjacentHTML('beforeend', html);
            currentUdemyCount += batch.length;
            lucide.createIcons();
        }

        function shareLink(title, url) {
            if (navigator.share) {
                navigator.share({ title: title, text: `ÙƒÙˆØ¨ÙˆÙ† Ù…Ø¬Ø§Ù†ÙŠ: ${title}`, url: url }).catch(console.error);
            } else {
                navigator.clipboard.writeText(url);
                alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒÙˆØ±Ø³! ğŸ˜‰');
            }
        }
    </script>
</body>
</html>