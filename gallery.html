<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- ğŸ‘ˆ Ø¯Ù‡ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ù„ÙŠ Ø¨ÙŠØ¸Ø¨Ø· Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ -->
    <title>ÙƒÙ…Ø´ÙƒØ§Ø© | Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ…ÙŠÙ…Ø§Øª</title>
    <link rel="icon" type="image/png" href="images/ui/logo.png">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
</head>
<body data-page="gallery">
    <div class="fixed-bg"><img src="images/ui/bg.jpg"></div>
    <div id="header-ph"></div> 

    <!-- Lightbox (Ø¹Ø§Ø±Ø¶ Ø§Ù„ØµÙˆØ±) -->
    <div id="lightbox" onclick="closeLightbox()" class="fixed inset-0 z-[9999] hidden bg-black/90 backdrop-blur-sm flex items-center justify-center p-4">
        <button class="absolute top-5 right-5 bg-white/10 text-white p-3 rounded-full hover:bg-white/20 transition z-50">
            <i data-lucide="x" class="w-6 h-6"></i>
        </button>
        
        <img id="lightbox-img" src="" class="max-h-[85vh] max-w-full rounded-lg shadow-2xl" onclick="event.stopPropagation()">
        
        <a id="lightbox-download" href="#" download class="absolute bottom-8 bg-emerald-600 text-white px-8 py-3 rounded-full font-bold shadow-2xl flex items-center gap-2 hover:bg-emerald-700 transition transform hover:scale-105" onclick="event.stopPropagation()">
            <i data-lucide="download" class="w-5 h-5"></i> ØªØ­Ù…ÙŠÙ„
        </a>
    </div>

    <main class="pt-32 px-4 container mx-auto min-h-screen pb-12">
        <div class="text-center mb-12 fade-in">
            <h1 class="text-3xl md:text-5xl font-black text-emerald-900 mb-2">Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ…ÙŠÙ…Ø§Øª</h1>
            <p class="text-slate-600 font-bold text-lg">Ø¥Ø¨Ø¯Ø§Ø¹ Ù…ØªØ¬Ø¯Ø¯ . Ù„Ù…Ø³Ø© ÙÙ†ÙŠØ©</p>
        </div>

        <!-- Ø´Ø¨ÙƒØ© Ø§Ù„ØµÙˆØ± (Masonry Grid) -->
        <div id="gallery-grid" class="masonry-grid fade-in delay-100">
            <!-- Ø§Ù„ØµÙˆØ± Ù‡ØªÙ†Ø²Ù„ Ù‡Ù†Ø§ -->
        </div>

        <div class="text-center mt-12 fade-in">
            <button id="load-more-gallery" class="bg-white text-emerald-800 px-8 py-3 rounded-full font-bold hover:bg-emerald-50 transition border border-emerald-200 shadow-md inline-flex items-center gap-2">
                Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ <i data-lucide="arrow-down" class="w-5 h-5"></i>
            </button>
        </div>
    </main>

    <div id="footer-ph"></div>

    <script>
        // --- Ù„ÙˆØ¬ÙŠÙƒ Ø§Ù„Ù…Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„ØµÙØ­Ø© Ø¯ÙŠ ---
        let visibleGalleryCount = 0;
        const GALLERY_INCREMENT = 5; // Ø¹Ø±Ø¶ 5 ØµÙˆØ± ÙÙŠ ÙƒÙ„ Ù…Ø±Ø©
        
        // Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ù„ÙØ§ØªÙƒ: Ø§Ù„ØµÙˆØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ù† 1.jpg Ù„Ù€ 10.jpg ÙÙŠ ÙÙˆÙ„Ø¯Ø± ui
        const MAX_IMAGES = 10; 

        document.addEventListener('DOMContentLoaded', () => {
            loadGalleryBatch();

            document.getElementById('load-more-gallery').addEventListener('click', () => {
                loadGalleryBatch();
            });
        });

        function loadGalleryBatch() {
            const grid = document.getElementById('gallery-grid');
            const btn = document.getElementById('load-more-gallery');
            
            let start = visibleGalleryCount + 1;
            let end = start + GALLERY_INCREMENT - 1;

            if (start > MAX_IMAGES) {
                btn.style.display = 'none';
                return;
            }

            if (end >= MAX_IMAGES) {
                end = MAX_IMAGES;
                btn.style.display = 'none';
            }

            let html = '';
            for(let i=start; i<=end; i++) {
                // ğŸ‘‡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…: Ø§Ù„Ù…Ø³Ø§Ø± ÙŠÙ‚Ø±Ø£ Ù…Ù† images/ui
                const imgSrc = `images/ui/${i}.jpg`; 

                html += `
                <div class="break-inside-avoid mb-6 glass-panel rounded-2xl overflow-hidden group relative fade-in bg-white/40 border border-white">
                    <div class="cursor-pointer relative" onclick="openGalleryLightbox('${imgSrc}')">
                        <img src="${imgSrc}" loading="lazy" class="w-full h-auto" 
                             onerror="this.parentElement.parentElement.style.display='none'">
                        
                        <!-- Ø·Ø¨Ù‚Ø© Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ… -->
                        <div class="absolute inset-0 bg-emerald-900/40 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
                            <div class="bg-white text-emerald-800 px-4 py-2 rounded-full font-bold flex gap-2 shadow-xl transform translate-y-4 group-hover:translate-y-0 transition">
                                <i data-lucide="zoom-in" class="w-4 h-4"></i> ØªÙƒØ¨ÙŠØ±
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ (ØªØ­Øª Ø§Ù„ØµÙˆØ±Ø©) -->
                    <div class="p-3 flex justify-between items-center bg-white/60 backdrop-blur-md">
                        <!-- Ø²Ø± Ø§Ù„Ù„Ø§ÙŠÙƒ -->
                        <button onclick="toggleLike(${i})" class="flex items-center gap-1 text-slate-500 hover:text-red-500 transition group/like">
                            <i data-lucide="heart" class="w-5 h-5 transition transform group-active/like:scale-125" id="heart-${i}"></i>
                            <span id="likes-count-${i}" class="text-xs font-bold">0</span>
                        </button>

                        <!-- Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (ÙˆØ§Ø¶Ø­ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±) -->
                        <button onclick="shareGalleryImage('${imgSrc}')" class="flex items-center gap-1 bg-emerald-100 hover:bg-emerald-200 text-emerald-700 px-3 py-1.5 rounded-lg text-xs font-bold transition">
                            Ù…Ø´Ø§Ø±ÙƒØ© <i data-lucide="share-2" class="w-3 h-3"></i>
                        </button>
                    </div>
                </div>`;
            }

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            while (tempDiv.firstChild) {
                grid.appendChild(tempDiv.firstChild);
            }
            
            visibleGalleryCount = end;
            lucide.createIcons();
            
            // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ø§Ù„Ù„Ø§ÙŠÙƒØ§Øª Ù…Ù† main.js Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©
            if(typeof listenToLikes === 'function') {
                listenToLikes(visibleGalleryCount);
            }
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ù„Ø§ÙŠØª Ø¨ÙˆÙƒØ³ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ØµÙØ­Ø©
        function openGalleryLightbox(src) {
            const lb = document.getElementById('lightbox');
            const img = document.getElementById('lightbox-img');
            const dl = document.getElementById('lightbox-download');
            
            img.src = src;
            dl.href = src;
            lb.classList.remove('hidden');
            lb.classList.add('flex'); // Ø¹Ø´Ø§Ù† ÙŠØ¸Ù‡Ø± ÙÙ„ÙŠÙƒØ³
        }

        function closeLightbox() {
            const lb = document.getElementById('lightbox');
            lb.classList.add('hidden');
            lb.classList.remove('flex');
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        function shareGalleryImage(imgSrc) {
            const fullUrl = window.location.origin + window.location.pathname.replace('gallery.html', '') + imgSrc;
            if (navigator.share) {
                navigator.share({
                    title: 'ØªØµÙ…ÙŠÙ… Ù…Ù† Ù…Ø¹Ø±Ø¶ ÙƒÙ…Ø´ÙƒØ§Ø©',
                    text: 'Ø´ÙˆÙ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ Ø¯Ù‡!',
                    url: fullUrl
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(fullUrl);
                alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©! ğŸ“¸');
            }
        }
    </script>
</body>
</html>