<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙƒÙ…Ø´ÙƒØ§Ø© | Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ…ÙŠÙ…Ø§Øª</title>
    <link rel="icon" type="image/png" href="images/ui/logo.png">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
</head>
<body data-page="gallery">
    <div class="fixed-bg"><img src="images/ui/bg.jpg" onerror="this.style.display='none'"></div>
    <div id="header-ph"></div> 

    <!-- Lightbox -->
    <div id="lightbox" onclick="closeLightbox()" class="fixed inset-0 z-[9999] hidden bg-black/95 backdrop-blur-md flex items-center justify-center p-2">
        <button class="absolute top-5 right-5 bg-white/10 text-white p-3 rounded-full hover:bg-white/20 transition z-50">
            <i data-lucide="x" class="w-6 h-6"></i>
        </button>
        <img id="lightbox-img" src="" class="max-h-[90vh] max-w-full rounded-lg shadow-2xl object-contain" onclick="event.stopPropagation()">
        <a id="lightbox-download" href="#" download class="absolute bottom-8 bg-emerald-600 text-white px-8 py-3 rounded-full font-bold shadow-2xl flex items-center gap-2 hover:bg-emerald-700 transition transform hover:scale-105" onclick="event.stopPropagation()">
            <i data-lucide="download" class="w-5 h-5"></i> ØªØ­Ù…ÙŠÙ„
        </a>
    </div>

    <main class="pt-32 px-4 container mx-auto min-h-screen pb-12">
        <div class="text-center mb-12 fade-in">
            <h1 class="text-3xl md:text-5xl font-black text-emerald-900 mb-2">Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ…ÙŠÙ…Ø§Øª</h1>
            <p class="text-slate-600 font-bold text-lg">Ø¥Ø¨Ø¯Ø§Ø¹ Ù…ØªØ¬Ø¯Ø¯ . Ù„Ù…Ø³Ø© ÙÙ†ÙŠØ©</p>
        </div>

        <div id="gallery-grid" class="masonry-grid"></div>

        <div class="text-center mt-12">
            <button id="load-more-gallery" class="bg-white text-emerald-800 px-8 py-3 rounded-full font-bold hover:bg-emerald-50 transition border border-emerald-200 shadow-md inline-flex items-center gap-2">
                Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ <i data-lucide="arrow-down" class="w-5 h-5"></i>
            </button>
        </div>
    </main>

    <div id="footer-ph"></div>

    <script>
        // ğŸ‘‡ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø§Ù„ØªÙŠ Ø±ÙØ¹ØªÙ‡Ø§
        const galleryImages = [
            "image_78d31a.png", "image_79433b.png", "image_79afde.png", "image_7a28f7.png",
            "image_7a2893.png", "image_7a3b5a.png", "image_8442aa.png", "image_849998.png",
            "image_858637.png", "image_86140a.png", "image_8613e6.png", "image_861429.png",
            "image_867239.png", "image_868be7.png", "image_868c2b.png", "image_868c0b.png",
            "image_be6765.png", "image_0ecbe7.png", "image_1b09ae.png", "image_1b0d91.png"
        ];

        let visibleGalleryCount = 0;
        const GALLERY_INCREMENT = 8; // Ø¹Ø±Ø¶ 8 ØµÙˆØ± ÙÙŠ ÙƒÙ„ Ù…Ø±Ø©

        document.addEventListener('DOMContentLoaded', () => {
            const grid = document.getElementById('gallery-grid');
            if(grid) grid.innerHTML = '';
            loadGalleryBatch();

            document.getElementById('load-more-gallery').addEventListener('click', () => {
                loadGalleryBatch();
            });
            
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            if (typeof lucide !== 'undefined') lucide.createIcons();
        });

        function loadGalleryBatch() {
            const grid = document.getElementById('gallery-grid');
            const btn = document.getElementById('load-more-gallery');
            
            let start = visibleGalleryCount;
            let end = start + GALLERY_INCREMENT;

            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø²Ø± Ù„Ùˆ Ø§Ù„ØµÙˆØ± Ø®Ù„ØµØª
            if (start >= galleryImages.length) {
                if(btn) btn.style.display = 'none';
                return;
            }
            if (end >= galleryImages.length) {
                end = galleryImages.length;
                if(btn) btn.style.display = 'none';
            }

            let html = '';
            for(let i=start; i<end; i++) {
                const imgName = galleryImages[i];
                // Ø§Ù„Ù…Ø³Ø§Ø±: images/Ø§Ø³Ù…_Ø§Ù„ØµÙˆØ±Ø©
                const imgSrc = `images/${imgName}`;
                // ØµÙˆØ±Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ùˆ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯Ø©
                const fallbackImg = `https://placehold.co/600x800/dcfce7/065f46?text=ØªØµÙ…ÙŠÙ…+${i+1}`;

                html += `
                <div class="break-inside-avoid mb-6 glass-panel rounded-2xl overflow-hidden group relative bg-white/40 border border-white hover:shadow-xl transition duration-300">
                    <div class="cursor-pointer relative" onclick="openGalleryLightbox('${imgSrc}')">
                        
                        <img src="${imgSrc}" loading="lazy" class="w-full h-auto block transform transition duration-500 group-hover:scale-105" 
                             onerror="this.onerror=null; this.src='${fallbackImg}'">
                        
                        <div class="absolute inset-0 bg-emerald-900/20 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
                            <div class="bg-white/90 text-emerald-900 p-3 rounded-full shadow-lg transform scale-75 group-hover:scale-100 transition">
                                <i data-lucide="zoom-in" class="w-6 h-6"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-3 flex justify-between items-center bg-white/80 backdrop-blur-md border-t border-white/50">
                        <button onclick="toggleLike(${i})" class="flex items-center gap-1.5 text-slate-500 hover:text-red-500 transition group/like">
                            <i data-lucide="heart" class="w-5 h-5 transition transform group-active/like:scale-125" id="heart-${i}"></i>
                            <span id="likes-count-${i}" class="text-xs font-bold font-sans mt-0.5">0</span>
                        </button>

                        <button onclick="shareGalleryImage('${imgSrc}')" class="text-emerald-600 hover:bg-emerald-50 p-2 rounded-lg transition" title="Ù…Ø´Ø§Ø±ÙƒØ©">
                            <i data-lucide="share-2" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>`;
            }

            grid.insertAdjacentHTML('beforeend', html);
            visibleGalleryCount = end;
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
            
            if(typeof listenToLikes === 'function') {
                listenToLikes(visibleGalleryCount);
            }
        }

        function openGalleryLightbox(src) {
            const lb = document.getElementById('lightbox');
            const img = document.getElementById('lightbox-img');
            const dl = document.getElementById('lightbox-download');
            img.src = src;
            dl.href = src;
            lb.classList.remove('hidden');
            lb.classList.add('flex');
        }

        function closeLightbox() {
            const lb = document.getElementById('lightbox');
            lb.classList.add('hidden');
            lb.classList.remove('flex');
        }

        function shareGalleryImage(src) {
            const fullUrl = src.startsWith('http') ? src : window.location.origin + window.location.pathname.replace('gallery.html', '') + src;
            if (navigator.share) {
                navigator.share({ title: 'ØªØµÙ…ÙŠÙ… Ù…Ù† ÙƒÙ…Ø´ÙƒØ§Ø©', url: fullUrl }).catch(console.error);
            } else {
                navigator.clipboard.writeText(fullUrl);
                alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©!');
            }
        }
    </script>
</body>
</html>